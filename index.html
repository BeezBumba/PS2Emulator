<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <link rel="icon" href="/favicon.ico"/>
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,orientation=landscape"/>
        <meta name="theme-color" content="#000000"/>
        <meta name="description" content="A PlayStation2 emulator for web browsers"/>
        <link rel="apple-touch-icon" href="/play-192.png"/>
        <link rel="manifest" href="/manifest.json"/>
        <title>Play!.js</title>
        <style>
            @media screen and (orientation: portrait) {
                #orientation-warning {
                    display:flex!important
                }

                #mobile-controls {
                    display: none!important
                }
            }

            #orientation-warning {
                display: none;
                position: fixed;
                left: 0;
                top: 0;
                width: 100vw;
                height: 100vh;
                background: rgba(0,0,0,.85);
                color: #fff;
                z-index: 3000;
                align-items: center;
                justify-content: center;
                text-align: center;
                font-size: 2em;
                padding: 2em
            }

            body {
                user-select: none;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                margin: 0;
                padding: 0;
                width: 100vw;
                height: 100vh;
                overflow: hidden
            }

            #outputCanvas {
                display: block;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%,-50%);
                background: #000;
                z-index: 1;
                width: 100vw;
                height: 56.25vw;
                max-width: 100vw;
                max-height: 100vh;
                border-radius: 0
            }

            @media (max-width: 900px) and (orientation:landscape) {
                #outputCanvas {
                    width:100vw;
                    height: 56.25vw;
                    max-height: 100vh;
                    max-width: 100vw
                }
            }

            @media (max-width: 900px) and (orientation:portrait) {
                #outputCanvas {
                    width:100vw;
                    height: 100vw;
                    max-height: 100vh;
                    max-width: 100vw
                }
            }

            #info-menu-toggle {
                position: fixed;
                top: 32px;
                right: 0;
                z-index: 2001;
                background: #222;
                color: #fff;
                border: none;
                border-radius: 8px 0 0 8px;
                box-shadow: 0 2px 8px #0004;
                padding: 8px 12px;
                cursor: pointer;
                transition: right .3s
            }

            #info-menu {
                position: fixed;
                top: 0;
                right: -340px;
                width: 320px;
                height: 100vh;
                background: #f8f8f8;
                box-shadow: -2px 0 16px #0002;
                z-index: 2000;
                display: flex;
                flex-direction: column;
                gap: 0;
                transition: right .3s;
                overflow-y: auto
            }

            #info-menu.open {
                right: 0
            }

            #info-menu-toggle.open {
                right: 320px
            }

            #info-arrow {
                transition: transform .3s
            }

            .mc-actions button:active,.mc-center-buttons button:active,.mc-dpad button:active,.mc-joystick .thumbstick:active,.mc-shoulder-left button:active,.mc-shoulder-right button:active {
                filter: brightness(1.5) drop-shadow(0 0 8px #fff8);
                outline: 2px solid #fff;
                box-shadow: 0 0 16px #fff8
            }

            .mc-actions button.pressed,.mc-center-buttons button.pressed,.mc-dpad button.pressed,.mc-joystick .thumbstick.pressed,.mc-shoulder-left button.pressed,.mc-shoulder-right button.pressed {
                filter: brightness(1.5) drop-shadow(0 0 8px #fff8);
                outline: 2px solid #fff;
                box-shadow: 0 0 16px #fff8
            }

            #mobile-controls {
                position: fixed;
                left: 0;
                bottom: -30%;
                width: 100vw;
                height: 100vh;
                pointer-events: none;
                z-index: 1000;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: center
            }

            .mc-grid-container {
                display: flex;
                justify-content: space-between;
                align-items: flex-end;
                width: 100%;
                padding: 0 3vw 2vh
            }

            .mc-left-column,.mc-right-column {
                display: flex;
                flex-direction: row;
                align-items: flex-end;
                gap: 20px;
                pointer-events: auto
            }

            .mc-center-buttons {
                pointer-events: auto;
                display: flex;
                align-items: center;
                gap: 16px;
                margin-bottom: 50px
            }

            .mc-center-buttons button {
                border-radius: 8px;
                padding: 8px 12px;
                font-size: .9em;
                background: #34495e;
                color: #fff;
                border: none;
                box-shadow: 0 2px 8px #0004
            }

            .mc-dpad {
                width: 160px;
                height: 160px;
                display: grid;
                grid-template-areas: ". up ." "left center right" ". down .";
                grid-template-columns: 1fr 1fr 1fr;
                grid-template-rows: 1fr 1fr 1fr;
                gap: 8px
            }

            .mc-dpad button {
                border-radius: 50%;
                width: 48px;
                height: 48px;
                font-size: 1.5em;
                background: #222;
                color: #fff;
                border: none;
                box-shadow: 0 2px 8px #0004
            }

            .mc-dpad .up {
                grid-area: up
            }

            .mc-dpad .down {
                grid-area: down
            }

            .mc-dpad .left {
                grid-area: left
            }

            .mc-dpad .right {
                grid-area: right
            }

            .mc-dpad .center {
                grid-area: center;
                opacity: 0
            }

            .mc-actions {
                width: 180px;
                height: 180px;
                display: grid;
                grid-template-areas: ". triangle ." "square cross circle" ". . .";
                grid-template-columns: 1fr 1fr 1fr;
                grid-template-rows: 1fr 1fr 1fr;
                gap: 8px
            }

            .mc-actions button {
                border-radius: 50%;
                width: 54px;
                height: 54px;
                font-size: 1.2em;
                border: none;
                box-shadow: 0 2px 8px #0004
            }

            .mc-actions .triangle {
                grid-area: triangle;
                background: #2ecc71;
                color: #fff
            }

            .mc-actions .square {
                grid-area: square;
                background: #e74c3c;
                color: #fff
            }

            .mc-actions .cross {
                grid-area: cross;
                background: #3498db;
                color: #fff
            }

            .mc-actions .circle {
                grid-area: circle;
                background: #e67e22;
                color: #fff
            }

            .mc-shoulder-left,.mc-shoulder-right {
                display: flex;
                flex-direction: column;
                gap: 8px
            }

            .mc-shoulder-left button,.mc-shoulder-right button {
                border-radius: 8px;
                padding: 8px 12px;
                font-size: .9em;
                background: #34495e;
                color: #fff;
                border: none;
                box-shadow: 0 2px 8px #0004
            }

            .mc-joystick {
                width: 120px;
                height: 120px;
                background: rgba(34,34,34,.5);
                border-radius: 50%;
                position: relative;
                box-shadow: 0 2px 8px #0004;
                user-select: none;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none
            }

            .mc-joystick .thumbstick {
                width: 60px;
                height: 60px;
                background: #ddd;
                border-radius: 50%;
                box-shadow: inset 0 2px 4px #0004,0 1px 2px #fff8;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%,-50%);
                touch-action: none;
                user-select: none;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none
            }
        </style>
        <script defer="defer" src="/static/js/main.caabe80b.js"></script>
        <link href="/static/css/main.5a525eca.css" rel="stylesheet">
    </head>
    <body>
        <noscript>You need to enable JavaScript to run this app.</noscript>
        <div class="global-row">
            <div class="global-column">
                <div>
                    <canvas id="outputCanvas" width="640" height="480" tabindex="-1"/>
                    <div style="margin:16px 0">
                        <label for="main-file-input" style="font-weight:700;display:block;margin-bottom:8px">Choose a game file:</label>
                        <input type="file" id="main-file-input" style="width:100%;max-width:320px"/>
                    </div>
                </div>
                <button id="info-menu-toggle" aria-label="Open info menu">
                    <span id="info-arrow" style="font-size:2em">&#x25C0;</span>
                </button>
                <aside id="info-menu">
                    <div style="padding:16px;background:#222;color:#fff;border-radius:8px;margin-bottom:16px;box-shadow:0 2px 8px #0002">
                        <h1 style="font-size:2em;margin-bottom:.2em">Play!</h1>
                        <div style="margin:16px 0">
                            <label for="slide-file-input" style="font-weight:700;display:block;margin-bottom:8px">Choose a game file:</label>
                            <p>
                                ISO, CSO, CHD, ISZ, BIN, and EL are supported. <br>
                                <br>This was created to allow people to use Play! on iOS devices without needing to jailbreak or sideload the app on their phone.
                            </p>
                            <input type="file" id="slide-file-input" style="width:100%;max-width:240px"/>
                        </div>
                    </div>
                    <div style="padding:16px;background:#fff;border-radius:8px;margin-bottom:16px;box-shadow:0 2px 8px #0002">
                        <h3>Links</h3>
                        <div>
                            <a href="https://purei.org" target="blank">Official Website</a>
                        </div>
                        <div>
                            <a href="https://github.com/jpd002/Play-" target="blank">Source Code</a>
                        </div>
                        <div>
                            <a href="https://github.com/jpd002/Play-Compatibility/issues" target="blank">Compatibility List</a>
                        </div>
                    </div>
                    <div style="padding:16px;background:#fff;border-radius:8px;margin-bottom:16px;box-shadow:0 2px 8px #0002">
                        <h3>Play! License</h3>
                        <div>
                            <p>Copyright (c) 2006-2014, Jean-Philip Desjardins All rights reserved. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
                        </div>
                    </div>
                </aside>
                <div id="root"></div>
                <div id="mobile-controls">
                    <div class="mc-grid-container">
                        <div class="mc-left-column">
                            <div class="mc-shoulder-left">
                                <button data-key="1">L1</button>
                                <button data-key="2">L2</button>
                                <button data-key="3">L3</button>
                            </div>
                            <div class="mc-left-side-stack">
                                <div class="mc-dpad">
                                    <button class="up" data-key="ArrowUp">▲</button>
                                    <button class="left" data-key="ArrowLeft">◀</button>
                                    <button class="center" tabindex="-1"></button>
                                    <button class="right" data-key="ArrowRight">▶</button>
                                    <button class="down" data-key="ArrowDown">▼</button>
                                </div>
                                <div id="left-joystick" class="mc-joystick">
                                    <div class="thumbstick"></div>
                                </div>
                            </div>
                        </div>
                        <div class="mc-center-buttons">
                            <button data-key="Backspace">SELECT</button>
                            <div style="width:20px;height:20px;background:#34495e;border-radius:50%;box-shadow:0 2px 8px #0004"></div>
                            <button data-key="Enter">START</button>
                        </div>
                        <div class="mc-right-column">
                            <div class="mc-right-side-stack">
                                <div class="mc-actions">
                                    <button class="cross" data-key="Z">✕</button>
                                    <button class="square" data-key="A">□</button>
                                    <button class="triangle" data-key="S">△</button>
                                    <button class="circle" data-key="X">◯</button>
                                </div>
                                <div id="right-joystick" class="mc-joystick">
                                    <div class="thumbstick"></div>
                                </div>
                            </div>
                            <div class="mc-shoulder-right">
                                <button data-key="8">R1</button>
                                <button data-key="9">R2</button>
                                <button data-key="0">R3</button>
                            </div>
                        </div>
                    </div>
                </div>
                <script>
                    document.addEventListener("DOMContentLoaded", (function() {
                        const e = document.getElementById("info-menu")
                          , t = document.getElementById("info-menu-toggle")
                          , n = document.getElementById("info-arrow");
                        let o = !1;
                        t.addEventListener("click", (function() {
                            o = !o,
                            e.classList.toggle("open", o),
                            t.classList.toggle("open", o),
                            n.innerHTML = o ? "&#x25B6;" : "&#x25C0;"
                        }
                        )),
                        document.getElementById("main-file-input").addEventListener("change", (function(e) {
                            const t = e.target;
                            if (t && t.files && 0 !== t.files.length) {
                                let e = t.files[0];
                                window.bootFile ? window.bootFile(e) : d("Game loader not available.", "Error")
                            }
                        }
                        )),
                        document.getElementById("slide-file-input").addEventListener("change", (function(e) {
                            const t = e.target;
                            if (t && t.files && 0 !== t.files.length) {
                                let e = t.files[0];
                                window.bootFile ? window.bootFile(e) : d("Game loader not available.", "Error")
                            }
                        }
                        ));
                        const i = document.getElementById("outputCanvas");
                        function d(e, t="Message") {
                            const n = `\n                  <div id="custom-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; justify-content: center; align-items: center;">\n                      <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; max-width: 80%; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">\n                          <h3 style="margin-top: 0;">${t}</h3>\n                          <p>${e}</p>\n                          <button id="close-modal" style="padding: 8px 16px; margin-top: 10px; border: none; border-radius: 5px; background: #3498db; color: white; cursor: pointer;">OK</button>\n                      </div>\n                  </div>\n              `;
                            document.body.insertAdjacentHTML("beforeend", n),
                            document.getElementById("close-modal").addEventListener("click", ( () => {
                                document.getElementById("custom-modal").remove()
                            }
                            ))
                        }
                        function s(e, t) {
                            let n = "";
                            1 === e.length ? n = "Key" + e.toUpperCase() : "Enter" === e ? n = "Enter" : "Backspace" === e ? n = "Backspace" : e.startsWith("Arrow") ? n = e : ["1", "2", "3", "8", "9", "0"].includes(e) && (n = "Digit" + e);
                            const o = new KeyboardEvent(t,{
                                key: e,
                                code: n,
                                bubbles: !0,
                                cancelable: !0,
                                isTrusted: !0
                            });
                            i && i.dispatchEvent(o),
                            window.dispatchEvent(o),
                            document.dispatchEvent(o)
                        }
                        function c(e, t) {
                            e.classList.add("pressed"),
                            s(t, "keydown"),
                            console.log(`Keydown event dispatched for: ${t}`)
                        }
                        function a(e, t) {
                            e.classList.remove("pressed"),
                            s(t, "keyup"),
                            console.log(`Keyup event dispatched for: ${t}`)
                        }
                        document.querySelectorAll("#mobile-controls button[data-key]").forEach((function(e) {
                            const t = e.getAttribute("data-key");
                            e.addEventListener("touchstart", (function(n) {
                                n.preventDefault(),
                                c(e, t)
                            }
                            )),
                            e.addEventListener("mousedown", (function(n) {
                                n.preventDefault(),
                                c(e, t)
                            }
                            )),
                            e.addEventListener("touchend", (function(n) {
                                n.preventDefault(),
                                a(e, t)
                            }
                            )),
                            e.addEventListener("mouseup", (function(n) {
                                n.preventDefault(),
                                a(e, t)
                            }
                            )),
                            e.addEventListener("mouseleave", (function(n) {
                                1 === n.buttons && a(e, t)
                            }
                            ))
                        }
                        ));
                        const l = document.getElementById("left-joystick")
                          , r = l.querySelector(".thumbstick")
                          , u = document.getElementById("right-joystick")
                          , f = u.querySelector(".thumbstick")
                          , m = {
                            up: "t",
                            down: "g",
                            left: "f",
                            right: "h"
                        }
                          , p = {
                            up: "i",
                            down: "k",
                            left: "j",
                            right: "l"
                        };
                        let g = new Set
                          , h = new Set
                          , v = !1
                          , y = !1;
                        function E(e, t, n, o, i, d) {
                            const c = e.getBoundingClientRect();
                            let a = n - (c.left + c.width / 2)
                              , l = o - (c.top + c.height / 2);
                            const r = Math.sqrt(a * a + l * l);
                            r > 30 && (a = a / r * 30,
                            l = l / r * 30),
                            t.style.transform = `translate(calc(-50% + ${a}px), calc(-50% + ${l}px))`,
                            t.classList.add("pressed");
                            const u = new Set;
                            l < -15 && u.add(i.up),
                            l > 15 && u.add(i.down),
                            a < -15 && u.add(i.left),
                            a > 15 && u.add(i.right),
                            u.forEach((e => {
                                d.has(e) || (s(e, "keydown"),
                                d.add(e))
                            }
                            )),
                            d.forEach((e => {
                                u.has(e) || (s(e, "keyup"),
                                d.delete(e))
                            }
                            ))
                        }
                        function w(e, t) {
                            e.style.transform = "translate(-50%, -50%)",
                            e.classList.remove("pressed"),
                            t.forEach((e => {
                                s(e, "keyup")
                            }
                            )),
                            t.clear()
                        }
                        l.addEventListener("mousedown", (e => {
                            e.preventDefault(),
                            v = !0,
                            E(l, r, e.clientX, e.clientY, m, g)
                        }
                        )),
                        l.addEventListener("touchstart", (e => {
                            e.preventDefault(),
                            v = !0;
                            const t = e.touches[0];
                            E(l, r, t.clientX, t.clientY, m, g)
                        }
                        ), !1),
                        u.addEventListener("mousedown", (e => {
                            e.preventDefault(),
                            y = !0,
                            E(u, f, e.clientX, e.clientY, p, h)
                        }
                        )),
                        u.addEventListener("touchstart", (e => {
                            e.preventDefault(),
                            y = !0;
                            const t = e.touches[0];
                            E(u, f, t.clientX, t.clientY, p, h)
                        }
                        ), !1),
                        window.addEventListener("mousemove", (e => {
                            v && E(l, r, e.clientX, e.clientY, m, g),
                            y && E(u, f, e.clientX, e.clientY, p, h)
                        }
                        )),
                        window.addEventListener("touchmove", (e => {
                            if (v) {
                                const t = Array.from(e.touches).find((e => e.target.closest("#left-joystick")));
                                t && E(l, r, t.clientX, t.clientY, m, g)
                            }
                            if (y) {
                                const t = Array.from(e.touches).find((e => e.target.closest("#right-joystick")));
                                t && E(u, f, t.clientX, t.clientY, p, h)
                            }
                        }
                        )),
                        window.addEventListener("mouseup", ( () => {
                            v && (v = !1,
                            w(r, g)),
                            y && (y = !1,
                            w(f, h))
                        }
                        )),
                        window.addEventListener("touchend", (e => {
                            v && (Array.from(e.touches).some((e => e.target.closest("#left-joystick"))) || (v = !1,
                            w(r, g))),
                            y && (Array.from(e.touches).some((e => e.target.closest("#right-joystick"))) || (y = !1,
                            w(f, h)))
                        }
                        ))
                    }
                    ))
                </script>
            </div>
            <div class="global-column" style="max-width:500px;overflow:auto">
                <div></div>
            </div>
        </div>
        <script src="/register.js"></script>
    </body>
</html>
